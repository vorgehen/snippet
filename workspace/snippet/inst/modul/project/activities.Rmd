---
title: "Snippets"
always_allow_html: true
output:
  html_document:
    self_contained: yes
  pdf_document: default
  word_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
```

# Einleitung
In diesem Projekt gibt es zwei Domänen: **SQM** und **SBM**. Für SQM ist noch nicht klar, welche Laufzeitumgebung eingesetzt wird, somit ist auch insbesondere das zu benutzende "Ökosystem" noch nicht bestimmt. Der SQM Service soll sogenannte Snippets (Informations-Fragmente der Domäne gerendert in verschiedenen Formaten) bereit stellen. Kandidaten sind eine JAVA Umgebung unter Weblogic, eine R Umgebung mit openCpu und eine BI Umgebung. 

In der SBM Domäne soll ein Prozess angewendet werden, die Ergebnisse des Prozesses werden als Dokumente in ein Document Management System (DMS) gespeichert werden. Die **Prozessanwendung** soll über **Oberflächentest**s abgesichert werden. 

Hier werden die Aktivitäten des Projekts und deren kritischer Pfad vorgestellt. Dazu wird das Package ProjectManagement benutzt, siehe [ProjectManagement: an R Package for
Managing Projects](https://rjournal.github.io/archive/2020/RJ-2020-009/RJ-2020-009.pdf).


# Aktivitäten

```{r durations, include=FALSE}
snippet::init()
# select(durationTable, +Aktivitätsnummer)
dt <-durationTable
  
```

```{r echo=FALSE, paged.print=FALSE}
dt %>%
  kableExtra::kbl(caption = "Aktivitätsbeschreibungen und deren Dauer") %>%
  kableExtra::kable_classic(full_width = F, html_font = "Cambria", position = "left")
```

## Aktivitätstypen:

- Type 1 Finish to start (FS): Aktivität kann gestartet werden, wenn der Vorgänger beendet wurde
- Type 2 Start to start (SS): Aktivität kann gestartet werden, wenn der Vorgänger gestartet wurde
- Type 3 Finish to finish (FF): Aktivität kann beendet werden, wenn der Vorgänger beendet wurde
- Type 4 Finish to start (FS): Aktivität kann beendet werden, wenn der Vorgänger gestartet wurde

### Type 1 und Type 2 Verbindungen
```{r eval=FALSE, message=FALSE, warning=FALSE, include=TRUE, paged.print=FALSE, results='hide', echo=TRUE}
  # Schnittstellen können erst betrachtet werden, wenn man die Fachmodelle inspiziert hat
  prec1and2[1, 3] <- 1
  prec1and2[2, 3] <- 1

  # Finalisierung Fachmodell kann erst begonnen werden wenn man auch die Schnittstellen betrachtet
  prec1and2[3, 4] <- 2
  prec1and2[3, 5] <- 2

  # Implementierung SQM kann erst begonnen werden, wenn Laufzeitumgebung bekannt
  prec1and2[6, 9] <- 1

  # SBM Implementierung kann erst begonnen werden, wenn Schnittstelle zu SQM klar ist und Fachmodell steht

  prec1and2[7, 10] <- 1
  prec1and2[5, 10] <- 1

  # SQM muss fertig sein, um in SBM integriert werden können
  prec1and2[9, 11] <- 1

  # GUI soll in Feature Dateien beschrieben werden
  prec1and2[12, 13] <- 2

  # Oberflächentests brauchen Feature Dateien
  prec1and2[13, 14] <- 2

  # Prozessapplikation wird zusammen mit der GUI implementiert
  prec1and2[11, 15] <- 2

  # Prozessapplikation kann SBM Service (der SQM Mocks benutzt) verwenden
  prec1and2[10, 16] <- 1

  # Implementierung DMS Anbindung nach Klärung, wer verantwortlich ist
  prec1and2[18, 19] <- 1

  # Entscheidung Laufzeitumgebung SQM sollte wohl begründet sein
  prec1and2[20, 6] <- 1
  prec1and2[21, 6] <- 1
  prec1and2[22, 6] <- 1
```

`r tibble::tibble(Aktivitätsnummer =  c(1:length(aktivitaeten)), tibble::as_tibble(prec1and2)) %>%
  kableExtra::kbl() %>%
  kableExtra::kable_classic(full_width = F, html_font = "Cambria", position = "left")`

### Type 3 und Type 4 Verbindungen
```{r eval=FALSE, message=FALSE, warning=FALSE, include=TRUE, paged.print=FALSE, results='hide', echo=TRUE}

  # Fachmodell kann nur abgeschlossen werden, wenn Schnittstellen klar sind
  prec3and4[7, 4] <- 3
  prec3and4[8, 5] <- 3

  # Entscheidung über DMS Verantwortlichkeit nach Klärung Scnittstellen SBM
  prec3and4[8, 17] <- 3
```

`r  tibble::tibble(Aktivitätsnummer =  c(1:length(aktivitaeten)), tibble::as_tibble(prec3and4)) %>%
  kableExtra::kbl() %>%
  kableExtra::kable_classic(full_width = F, html_font = "Cambria", position = "left")`

# Critical Path


```{r cp, echo=FALSE, fig.height=10, fig.width=10, include=TRUE}
calcDauer <- snippet::criticalPath()
```
Berechnete Dauer: `r  calcDauer`


# Schedule
Das Widget zur Darstellung kann innerhalb der Library und innerhalb des Markdowns nicht gerendert werden (siehe modul/project/schedule.Rmd, wo noch ein wenig Statistik zum Projekt dargestellt wird, um noch weitere Charts und Tabellen zu präsentieren). Es kann aber als Snippet geholt werden, siehe Demo.

# Demo
1. Diese Seite POST ../library/snippet/modul/project/activities.Rmd (auch PDF holen)
2. Schedule: POST ../library/snippet/modul/project/schedule.Rmd
   -> GET ... /ocpu/tmp/<id>/files/schedule.html Widget hat Fehler 
3. Direkt holen: POST ../library/snippet/R/scheduleWidget, GET ...ocpu/tmp/<ID>/R/.val/bin, umbenennen in .html
4. Funktionsaufruf mit Parameter: POST ../library/snippet/R/getDurationOfAktivitaet/json, param i=2
